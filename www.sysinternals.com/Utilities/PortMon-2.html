<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Sysinternals Freeware - Portmon</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<base />
<style type="text/css">
    @import "../includes/main.css";
</style>
<script type="text/javascript" src="../includes/main.js"></script>
<link rel="alternate" title="Sysinternals RSS" href="../sysinternals.xml" type="application/rss+xml">
<link rel="shortcut icon" href="../favicon.html" type"image/x-icon">
</head>

<body>

<a name="top"></a>
<div class="headercontainer">
    <div class="header">
        <a href="../index.html"><span>Sysinternals Freeware - Mark Russinovich &amp; Bryce Cogswell</span></a>
        <ul>
            <li>Advanced Utilities</li>
            <li>Technical Information</li>
            <li>Source Code</li>
        </ul>
    </div>
</div>


<div class="navmaincontainer">
    <ul class="navmain">
        <li><a href="../Utilities.html">Utilities</a>
            <ul>
                <li><a href="../FileAndDiskUtilities.html">File and Disk</a></li>
                <li><a href="../SecurityUtilities.html">Security</a></li>
                <li><a href="../NetworkingUtilities.html">Networking</a></li>
                <li><a href="../ProcessesAndThreadsUtilities.html">Processes &amp; Threads</a></li>
                <li><a href="../SystemInformationUtilities.html">System Information</a></li>
                <li><a href="../MiscellaneousUtilities.html">Miscellaneous</a></li>
            </ul>
        </li>
        <li><a href="../SourceCode.html">Source Code </a></li>
        <li><a href="../Information.html">Information</a></li>
        <li><a href="../Blog/index.html">Mark's Blog</a></li>
        <li><a href="../../forum.sysinternals.com/index.html">Forum</a></li>

        <li><a href="../chat/index.html" id="chatlink">Chat</a></li>
        <li id="newsletter">
            <div>
                <a href="../Information/SysinternalsNewsletter.html" style="background: none">Newsletter</a>
                <form method="get" action="http://groups.yahoo.com/subscribe/sysinternals">
                    <input type="text" size="18" name="user" value="email address" onfocus="this.value=''" style="width: 130px" /><br />
                    <input type="image" name="submit_email" src="../images/NewsletterSignupButton.gif" alt="Sign Up" style="margin-top: 3px; width: 53px; height: 21px; border: none" />
                </form>
            </div>
        </li>
    </ul>
    
    <a href="http://www.winternals.com/"><img src="../images/WinternalsSponsor.gif" width="149" height="55" alt="Sponsored by Winternals" style="margin: 30px 0 0 8px; border: none" /></a>
</div>

<div style="position: absolute; top: 20px; left: 0;">
    <form method="get" action="http://www.sysinternals.com/search/default.aspx" style="display: inline">
        <input type="text" size="13" name="query" value="search" onclick="this.value=''" style="width: 100px" />
        <input type="image" src="../images/SearchButton.gif" alt="Search" style="margin-left: 5px; width: 20px; height: 16px; vertical-align: middle; border: none" />
    </form>
</div>


<div class="contentbox">
    <h1>Portmon for Windows NT/9x</h1>
    <div class="info">
        Copyright © 1998-1999 <a href="mailto:mark@sysinternals.com">Mark Russinovich</a><br />
        <span>Last Updated: June 13, 2000 v3.02</span>
    </div>
    
    <h2>Introduction</h2>
    <p>
        <i>Portmon</i> is a utility that monitors and displays all serial and parallel port activity on a system. It has advanced filtering and search capabilities that make it a powerful tool for exploring the way Windows works, seeing how applications use ports, or tracking down problems in system or application configurations.
    </p>
    <p>
        <i>Portmon</i> works on NT 4.0, Win2K, XP and Server 2003, Windows 95 and Windows 98.
    </p>
    
    <h2>Portmon 3.x</h2>
    <p>
        Version 3.x of <i>Portmon</i> marks the introduction of a number of powerful features.
    </p>
    <ul>
        <li><b>Remote monitoring:</b> Capture kernel-mode and/or Win32 debug output from any computer accessible via TCP/IP - even across the Internet. You can monitor multiple remote computers simultaneously. <i>Portmon</i> will even install its client software itself if you are running it on a Windows NT/2K system and are capturing from another Windows NT/2K system in the same Network Neighborhood.</li>
        <li><b>Most-recent-filter lists::</b> <i>Portmon</i> has been extended with powerful filtering capabilities and it remembers your most recent filter selections, with an interface that makes it easy to reselect them.</li>
        <li><b>Clipboard copy::</b> Select multiple lines in the output window and copy their contents to the clipboard.</li>
        <li><b>Highlighting::</b> Highlight debug output that matches your highlighting filter, and even customize the highlighting colors.</li>
        <li><b>Log-to-file::</b> Write debug output to a file as its being captured.</li>
        <li><b>Printing::</b> Print all or part of captured debug output to a printer.</li>
        <li><b>One-file payload::</b> <i>Portmon</i> is now implemented as one file.</li>
    </ul>
    <p>
        The on-line help-file describes all these features, and more, in detail.
    </p>
    <img src="../images/screenshots/PortMon.gif" width="549" height="343" alt="PortMon Screenshot" />
    
    <h2>Installation and Use</h2>
    <p>
        Simply execute the <i>Portmon</i> program file (portmon.exe) and <i>Portmon</i> will immediately start capturing debug output. 
        To run <i>Portmon</i> on Windows 95 you must get the 
        <a href="http://www.microsoft.com/windows95/downloads/contents/wuadmintools/s_wunetworkingtools/w95sockets2/default.asp?site=95">WinSock2 update</a> 
        from Microsoft. Note that if you run <i>Portmon</i> on Windows NT/2K portmon.exe must be located on a non-network drive and you must 
        have administrative privilege. Menus, hot-keys, or toolbar buttons can be used to clear the window, save the monitored data to a file, 
        search output, change the window font, and more. The on-line help describes all of <i>Portmon's</i> features.
    </p>
    <p>
        <i>Portmon</i> understands all serial and parallel port I/O control (IOCTLs) commands and will display them along with interesting information regarding their associated parameters. For read and write requests <i>Portmon</i> displays the first several dozen bytes of the buffer, using '.' to represent non-printable characters. The Show Hex menu option lets you toggle between ASCII and raw hex output of buffer data.
    </p>
    
    <h2>How it Works: WinNT</h2>
    <p>
        The <i>Portmon</i> GUI is responsible for identifying serial and parallel ports. It does so by enumerating the serial ports that are configured under HKEY_LOCAL_MACHINE\Hardware\DeviceMap\SerialComm and the parallel ports defined under HKEY_LOCAL_MACHINE\Hardware\DeviceMap\Parallel Ports. These keys contain the mappings between serial and parallel port device names and the Win32-accessible names.
    </p>
    <p>
        When you select a port to monitor, <i>Portmon</i> sends a request to its device driver that includes the NT name 
        (e.g. \device\serial0) that you are interested in. The driver uses standard filtering APIs to attach its own filter 
        device object to the target device object. First, it uses <b>ZwCreateFile</b> to open the target device. Then it translates 
        the handle it receives back from <b>ZwCreateFile</b> to a device object pointer. After creating its own filter device object 
        that matches the characteristics of the target, the driver calls <b>IoAttachDeviceByPointer</b> to establish the filter. From 
        that point on the <i>Portmon</i> driver will see all requests aimed at the target device.
    </p>
    <p>
        <i>Portmon</i> has built-in knowledge of all standard serial and parallel port IOCTLs, which are the primary way that applications and drivers configure and read status information from ports. The IOCTLs are defined in the DDK file \ddk\src\comm\inc\ntddser.h and \ddk\src\comm\inc\ntddpar.h, and some are documented in the DDK.
    </p>
    
    <h2>How it Works: Win9x</h2>
    <p>
        On Windows 95 and 98, the <i>Portmon</i> GUI relies on a dynamically loaded VxD to capture serial and parallel activity. The Windows VCOMM (Virtual Communications) device driver serves as the interface to parallel and serial devices, so applications that access ports indirectly use its services. The <i>Portmon</i> VxD uses standard VxD service hooking to intercept all accesses to VCOMM's functions. Like its NT device driver, <i>Portmon</i>'s VxD interprets requests to display them in a friendly format. On Win9x <i>Portmon</i> monitors all ports so there is no port selection like on NT.
    </p>
    
    <h2>Related Utilities</h2>
    <p>
        Here are some other monitoring tools available at Sysinternals:
    </p>
    <ul>
        <li><a href="Regmon.html">Regmon</a> - a Registry monitor</li>
        <li><a href="Filemon.html">Filemon</a> - a file system monitor</li>
        <li><a href="TdiMon.html">TDIMon</a> - a TCP/IP monitor</li>
        <li><a href="PMon.html">PMon</a> - a process and thread monitor (NT/Win2K)</li>
        <li><a href="Diskmon.html">Diskmon</a> - a hard disk monitor (NT/Win2K)</li>
        <li><a href="DebugView.html">DebugView/EE</a> - a debug output monitor</li>
    </ul>
    <p>
        <b>In order to help us track its use, please download through the link that represents the operating system on which you will use or mostly use Portmon. Note that the zip files are identical, and Portmon runs on either platform.</b>
    </P>
    
    <p class="download">
        <a href="../../download.sysinternals.com/Files/PortMon9x.zip">Download Portmon (x86 - 52KB) - you plan on using Portmon on Win9x</a>
        <br /><br />
        
        <a href="../../download.sysinternals.com/Files/PortMonNt.zip">Download Portmon (x86 - 52KB) - you plan on using Portmon on WinNT </a>
    </p>
    
    <p>
        <a href="PortMon-2.html#top">Back to Top</a>
    </p>
</div>

<ul class="navmisc">
    <li><a href="../index-2.html">Home</a></li>
    <li><a href="../Resources.html">Resources</a></li>
    <li><a href="../SysinternalsSiteMap.html">Site Map</a></li>
    <li><a href="../Licensing.html">Licensing</a></li>
    <li><a href="../AboutUs.html">About Us</a></li>
</ul>
<div class="footer">
	Copyright © 2006 Sysinternals. All rights reserved. | <a href="../PrivacyStatement.html">Privacy Statement</a>
</div>


</body>
</html>