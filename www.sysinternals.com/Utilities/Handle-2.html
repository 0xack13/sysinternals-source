<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Sysinternals Freeware - Handle</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<base />
<style type="text/css">
    @import "../includes/main.css";
</style>
<script type="text/javascript" src="../includes/main.js"></script>
<link rel="alternate" title="Sysinternals RSS" href="../sysinternals.xml" type="application/rss+xml">
<link rel="shortcut icon" href="../favicon.html" type"image/x-icon">
</head>

<body>

<a name="top"></a>
<div class="headercontainer">
    <div class="header">
        <a href="../index.html"><span>Sysinternals Freeware - Mark Russinovich &amp; Bryce Cogswell</span></a>
        <ul>
            <li>Advanced Utilities</li>
            <li>Technical Information</li>
            <li>Source Code</li>
        </ul>
    </div>
</div>


<div class="navmaincontainer">
    <ul class="navmain">
        <li><a href="../Utilities.html">Utilities</a>
            <ul>
                <li><a href="../FileAndDiskUtilities.html">File and Disk</a></li>
                <li><a href="../SecurityUtilities.html">Security</a></li>
                <li><a href="../NetworkingUtilities.html">Networking</a></li>
                <li><a href="../ProcessesAndThreadsUtilities.html">Processes &amp; Threads</a></li>
                <li><a href="../SystemInformationUtilities.html">System Information</a></li>
                <li><a href="../MiscellaneousUtilities.html">Miscellaneous</a></li>
            </ul>
        </li>
        <li><a href="../SourceCode.html">Source Code </a></li>
        <li><a href="../Information.html">Information</a></li>
        <li><a href="../Blog/index.html">Mark's Blog</a></li>
        <li><a href="../../forum.sysinternals.com/index.html">Forum</a></li>

        <li><a href="../chat/index.html" id="chatlink">Chat</a></li>
        <li id="newsletter">
            <div>
                <a href="../Information/SysinternalsNewsletter.html" style="background: none">Newsletter</a>
                <form method="get" action="http://groups.yahoo.com/subscribe/sysinternals">
                    <input type="text" size="18" name="user" value="email address" onfocus="this.value=''" style="width: 130px" /><br />
                    <input type="image" name="submit_email" src="../images/NewsletterSignupButton.gif" alt="Sign Up" style="margin-top: 3px; width: 53px; height: 21px; border: none" />
                </form>
            </div>
        </li>
    </ul>
    
    <a href="http://www.winternals.com/"><img src="../images/WinternalsSponsor.gif" width="149" height="55" alt="Sponsored by Winternals" style="margin: 30px 0 0 8px; border: none" /></a>
</div>

<div style="position: absolute; top: 20px; left: 0;">
    <form method="get" action="http://www.sysinternals.com/search/default.aspx" style="display: inline">
        <input type="text" size="13" name="query" value="search" onclick="this.value=''" style="width: 100px" />
        <input type="image" src="../images/SearchButton.gif" alt="Search" style="margin-left: 5px; width: 20px; height: 16px; vertical-align: middle; border: none" />
    </form>
</div>


<div class="contentbox">
    <h1>Handle</h1>
    <div class="info">
        Copyright © 1997-2006 <a href="mailto:mark@sysinternals.com">Mark Russinovich</a><br />
  <span>Last Updated: June 6, 2006 v3.2</span></div>
    
    <h2>Introduction</h2>
    <p>
        Ever wondered which program has a particular file or directory open? Now you can find out. <i>Handle</i> is a utility that displays information about open handles for any process in the system. You can use it to see the programs that have a file open, or to see the object types and names of all the handles of a program.
    </p>
    <p>
        You can also get a GUI-based version of this program, <a href="ProcessExplorer.html"><i>Process Explorer</i></a>, here at Sysinternals.
    </p>
    
    <h2>Installation</h2>
    <p>
        You run <i>Handle</i> by typing "handle". You must have administrative privilege to run <i>Handle</i>.
    </p>
    <p>
        <i>Handle</i> works on Windows 9x/Me and Windows NT and higher as well as x64 Windows XP and Windows Server 2003 64-bit Editions.</p>
    
    <h2>Usage</h2>
    <p>
        <i>Handle</i> is targetted at searching for open file references, so if you do not specify any command-line parameters it will list the values of all the handles in the system that refer to open files and the names of the files. It also takes several parameters that modify this behavior.
    </p>
    <p>
        <b>usage: handle [[-a] [-u] | [-c &lt;handle&gt; [-y]] | [-s]] [-p &lt;processname&gt;|&lt;pid>&gt; [name]</b>
    </p>
    <dl class="usage">
        <dt>-a</dt>
            <dd>Dump information about all types of handles, not just those that refer to files. Other types include ports, Registry keys, synchronization primitives, threads, and processes.</dd>
        <dt>-c</dt>
      <dd>Closes the specified handle (interpreted as a hexadecimal number). You must specify the process by its PID.
            <br />
        WARNING: Closing handles can cause application or system instability.</dd>
      <dt>-y</dt>
      <dd>Don't prompt for close handle confirmation.</dd>
      <dt>-s</dt>
            <dd>Print count of each type of handle open.</dd>
        <dt>-u</dt>
            <dd>Show the owning user name when searching for handles.</dd>
        <dt>-p</dt>
            <dd>Instead of examining all the handles in the system, this parameter narrows Handle's scan to those processes that begin with the name process. Thus:
            <br /><br />
            <b>handle -p exp</b>
            <br /><br />
            would dump the open files for all processes that start with "exp", which would include Explorer.</dd>
        <dt>name</dt>
            <dd>This parameter is present so that you can direct Handle to search for references to an object with a particular name. For example, if you wanted to know which process (if any) has "c:\windows\system32" open you could type:
            <br /><br />
            <b>handle windows\system</b>
            <br /><br />
            The name match is case-insensitive and the fragment specified can be anywhere in the paths you are interested in</dd>
    </dl>
    
    <h2>Handle Output</h2>
    <p>
        When not in search mode (enabled by specifying a name fragment as a parameter), Handle divides its output into sections for each process it is printing handle information for. Dashed lines are used as a separator, immediately below which you will see the process name and its process id (PID). Beneath the process name are listed handle values (in hexadecimal), the type of object the handle is associated with, and the name of the object if it has one.
    </p>
    <p>
        When in search mode, <i>Handle</i> prints the process names and id's are listed on the left side and the names of the objects that had a match are on the right.
    </p>
    
    <h2>More Information</h2>
    <p>
        You can find more information on the Object Manager in 
        <a href="../WindowsInternals.html">Windows Internals, 4th Edition</a> or by browsing the Object Manager name-space with <a href="WinObj.html">WinObj</a>.
    </p>
    
    <h2>Related Tools</h2>
    <p>
        Here are some other monitoring tools available at Sysinternals:
    </p>
    <ul>
        <li><a href="ProcessExplorer.html">Process Explorer</a> - a GUI-based DLL and handle viewer for Win9x/Me and NT/Win2K</li>
        <li><a href="ListDlls.html">ListDLLs</a> - a command-line DLL viewer for Win9x/Me and NT/Win2K</li>
    </ul>
    
    <h2>Microsoft Handle KB Articles</h2>
    <p>
        The following Microsoft KB articles reference Handle for diagnosing or troubleshooting various problems:
    </p>
    <ul>
        <li><a href="http://support.microsoft.com/support/kb/articles/q245/0/68.asp">245068: Err Msg: Access is Denied. You Don't Have Permissions or the File is in Use</a></li>
        <li><a href="http://support.microsoft.com/support/kb/articles/Q276/5/25.asp">276525: Your Computer May Stop Responding When You Monitor Open Handles</a></li>
    </ul>

    
    <p class="download">
  <a href="../../download.sysinternals.com/Files/Handle.zip">Download Handle (180 KB)</a>  </p>
    <p>
        <a href="Handle-2.html#top">Back to Top</a>
    </p>
</div>

<ul class="navmisc">
    <li><a href="../index-2.html">Home</a></li>
    <li><a href="../Resources.html">Resources</a></li>
    <li><a href="../SysinternalsSiteMap.html">Site Map</a></li>
    <li><a href="../Licensing.html">Licensing</a></li>
    <li><a href="../AboutUs.html">About Us</a></li>
</ul>
<div class="footer">
	Copyright © 2006 Sysinternals. All rights reserved. | <a href="../PrivacyStatement.html">Privacy Statement</a>
</div>


</body>
</html>